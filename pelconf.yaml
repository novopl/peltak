# peltak configuration file
# See https://github.com/novopl/peltak for more information.
pelconf_version: '0'

# A list of py modules with commands that should be available for the project.
commands:
  - peltak.extra.changelog
  - peltak.extra.git
  - peltak.extra.gitflow
  - peltak.extra.pypi
  - peltak.extra.version

# General project settings - used by many commands
src_dir: 'src'
version:
  file: 'src/peltak/__init__.py'

# Configure what gets deleted when running `peltak clean`
clean:
  exclude:
    - ".venv"

src_path: 'src/peltak'
build_dir: '.build'

# Configure your docker registry and images within the project
docker:
  registry: docker.novocode.net


# Custom scripts
scripts:
  # root scripts
  check:
    about: Run all checks (types, pep8, code style)
    command_file: ops/scripts/check.sh.j2
    root_cli: true
    files:
      paths:
        - src/peltak
        - test/unit
      include: "*.py"
      use_gitignore: true

  test:
    about: Run unit tests
    command_file: ops/scripts/test.sh.j2
    root_cli: true
    options:
      - name: ['--no-sugar']
        is_flag: true
        about: Disable pytest-sugar. Might be useful for CI runs.
      - name: ['--cov']
        type: str
        default: all
        about: |
          What type of coverage should we define. Allowed values are:
          all/core/scripts/extra. Defaults to 'all'.

  docs:
    about: Generate sphinx documentation
    command_file: ops/scripts/docs.sh.j2
    root_cli: true
    options:
      - name: ['--recreate']
        about: Delete build and out directories before running.
        is_flag: true
      - name: ['--run-doctests']
        about: Also run all doctests.
        is_flag: true

  # run scripts
  check-commit:
    about: Perform all checks on files staged for commit
    command_file: ops/scripts/check.sh.j2
    files:
      paths:
        - src/peltak
        - test/unit
      only_staged: true
      include: "*.py"
      use_gitignore: true
